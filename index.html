<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>COMPTA GPT 3000</title>
  <style>
    :root {
      --bg: #ffffff;
      --fg: #111827;
      --muted: #6b7280;
      --accent: #2563eb;
      --card: #ffffff;
      --border: #e5e7eb;
      --input: #ffffff;
      --input-border: #d1d5db;
      --pill-bg: #eef2ff;
      --pill-border: #c7d2fe;
    }
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica,Arial,sans-serif;
      background:var(--bg);color:var(--fg);
      display:flex;align-items:center;justify-content:center;
    }
    .wrap{width:min(880px,95vw);}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:20px 22px;
      box-shadow:0 6px 24px rgba(0,0,0,.06)
    }
    h1.mega{
      margin:0 0 14px;
      font-size: clamp(28px, 6vw, 56px);
      font-weight: 900;
      text-align:center;
      color:#1d4ed8;
    }
    p{margin:.25rem 0 .75rem;color:var(--muted)}
    label{display:block;margin:12px 0 6px;color:#374151;font-weight:600}
    input[type="text"],select,input[type="number"]{
      width:100%;padding:12px 14px;border-radius:12px;
      border:1px solid var(--input-border);
      background:var(--input);color:var(--fg);font-size:16px;
    }
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .btn{
      appearance:none;border:0;border-radius:12px;padding:12px 16px;
      background:var(--accent);color:#ffffff;font-weight:700;cursor:pointer
    }
    .subtle{background:#1118270d;color:#111827}
    .btn[disabled]{opacity:.6;cursor:not-allowed}
    .out{margin-top:12px;display:flex;gap:8px;align-items:center}
    .linkbox{
      flex:1;background:#f9fafb;border:1px solid var(--border);
      border-radius:10px;padding:10px 12px;overflow:auto;white-space:nowrap
    }
    .hint{font-size:12px;color:var(--muted)}
    .switch{display:flex;gap:14px;align-items:center;margin-top:10px}
    .switch input{margin-right:6px}

    .stage{position:relative;display:flex;flex-direction:column;align-items:center;gap:14px;padding:36px}
    .fake-search{
      display:flex;align-items:center;gap:10px;background:#fff;
      border:1px solid var(--input-border);border-radius:999px;
      padding:12px 16px;width:min(640px,90%)
    }
    .fake-search input{all:unset;color:#111827;font-size:18px;flex:1}
    .fake-search .mag{
      width:20px;height:20px;border-radius:50%;border:3px solid var(--accent);position:relative
    }
    .fake-search .mag:after{
      content:"";position:absolute;right:-7px;bottom:-7px;width:10px;height:3px;background:var(--accent);transform:rotate(45deg);border-radius:2px
    }
    .cursor{
      position:absolute;width:22px;height:22px;border:2px solid #111827;
      border-left-color:transparent;border-top-color:transparent;
      transform:rotate(45deg);border-radius:2px;left:20px;top:12px;
      transition:all .7s ease;opacity:.9;
    }
    .steps{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
    .pill{
      display:inline-block;background:var(--pill-bg);
      border:1px solid var(--pill-border);border-radius:999px;
      padding:6px 10px;color:#3730a3;font-size:12px;font-weight:600
    }
    .final-msg{
      margin-top:12px;
      font-size:14px;
      color:#047857;
      font-weight:600;
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="builder">
      <h1 class="mega">ðŸ¤– COMPTA GPT 3000 ðŸ¤–</h1>
      <p>GÃ©nÃ¨re un lien qui <em>montre</em> la saisie puis redirige vers un moteur de recherche.</p>

      <label for="q">RequÃªte</label>
      <input id="q" type="text" placeholder="Ex: paiement espÃ¨ce max journalier" />

      <div class="row">
        <div>
          <label for="engine">Moteur</label>
          <select id="engine">
            <option value="google">Google</option>
            <option value="ddg">DuckDuckGo</option>
            <option value="bing">Bing</option>
            <option value="qwant">Qwant</option>
            <option value="ecosia">Ecosia</option>
          </select>
        </div>
        <div>
          <label for="delay">DÃ©lai avant redirection (s)</label>
          <input id="delay" type="number" min="0" max="15" step="1" value="2"/>
        </div>
      </div>

      <div class="switch">
        <label><input type="checkbox" id="autoredirect" checked> Rediriger automatiquement</label>
        <label><input type="checkbox" id="newtab"> Ouvrir dans un nouvel onglet</label>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px">
        <button class="btn" id="gen">GÃ©nÃ©rer le lien</button>
        <button class="btn subtle" id="preview">AperÃ§u</button>
      </div>

      <div class="out" id="out" style="display:none">
        <div class="linkbox" id="linkbox"></div>
        <button class="btn" id="copy">Copier</button>
      </div>
    </div>

    <div class="card" id="player" style="display:none;margin-top:14px">
      <div class="stage">
        <h1 class="mega">ðŸ¤– COMPTA GPT 3000 ðŸ¤–</h1>
        <div class="cursor" id="cursor"></div>
        <div class="steps" id="steps"></div>
        <div class="fake-search">
          <div class="mag"></div>
          <input id="fakeInput" placeholder="Tape la requÃªte iciâ€¦"/>
        </div>
        <div class="hint">Ce lien va bientÃ´t tâ€™emmener vers <span id="engineName"></span>â€¦</div>
        <div class="final-msg" id="finalMsg" style="display:none">Tu vois c'Ã©tait pas si dur que Ã§a :D</div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const $ = s => document.querySelector(s);
      const e = encodeURIComponent;
      const ENGINES = {
        google: {name:'Google', url:q=>`https://www.google.com/search?q=${e(q)}`},
        ddg:    {name:'DuckDuckGo', url:q=>`https://duckduckgo.com/?q=${e(q)}`},
        bing:   {name:'Bing', url:q=>`https://www.bing.com/search?q=${e(q)}`},
        qwant:  {name:'Qwant', url:q=>`https://www.qwant.com/?q=${e(q)}`},
        ecosia: {name:'Ecosia', url:q=>`https://www.ecosia.org/search?q=${e(q)}`}
      };
      const params = new URLSearchParams(location.search);
      const hasQuery = params.has('q');

      $('#base')?.textContent = location.origin + location.pathname;
      const makeLink = () => {
        const q = $('#q').value.trim();
        const engine = $('#engine').value;
        const delay = Math.max(0, parseInt($('#delay').value||'0',10));
        const r = $('#autoredirect').checked ? 1 : 0;
        const nt = $('#newtab').checked ? 1 : 0;
        if(!q) return '';
        const url = new URL(location.href);
        url.search = new URLSearchParams({q, engine, delay, r, nt}).toString();
        return url.toString();
      };
      $('#gen')?.addEventListener('click', () => {
        const link = makeLink();
        if(!link){ alert('Entre une requÃªte d\'abord.'); return; }
        $('#linkbox').textContent = link;
        $('#out').style.display = 'flex';
      });
      $('#copy')?.addEventListener('click', async () => {
        const link = $('#linkbox').textContent;
        try{
          await navigator.clipboard.writeText(link);
          const old = $('#copy').textContent; $('#copy').textContent = 'CopiÃ© !';
          setTimeout(()=>$('#copy').textContent=old,900);
        }catch{ alert('Impossible de copier.'); }
      });
      $('#preview')?.addEventListener('click', () => {
        const link = makeLink();
        if(!link){ alert('Entre une requÃªte d\'abord.'); return; }
        location.href = link;
      });

      if(hasQuery){
        $('#builder').style.display='none';
        $('#player').style.display='block';
        const q = params.get('q');
        const engineKey = params.get('engine')||'google';
        const engine = ENGINES[engineKey] || ENGINES.google;
        const delay = Math.max(0, parseInt(params.get('delay')||'2',10));
        const redirect = (params.get('r')||'1')==='1';
        const newtab = (params.get('nt')||'0')==='1';
        $('#engineName').textContent = engine.name;

        const cursor = $('#cursor');
        const box = $('#fakeInput');
        const steps = $('#steps');
        const finalMsg = $('#finalMsg');

        const addStep = (txt) => {
          const el = document.createElement('div');
          el.className = 'pill';
          el.textContent = txt;
          steps.appendChild(el);
        };
        const moveCursorTo = (el) => {
          const r = el.getBoundingClientRect();
          cursor.style.left = (r.left + r.width*0.08 + window.scrollX) + 'px';
          cursor.style.top  = (r.top + r.height*0.5 + window.scrollY) + 'px';
        };

        addStep('Ouvrir ton navigateur');
        setTimeout(()=>{
          moveCursorTo(box);
          addStep('Taper ta question');
          box.focus();

          let i=0;
          const typer = setInterval(()=>{
            box.value = q.slice(0, i++);
            if(i>q.length){
              clearInterval(typer);
              addStep('Cliquer sur rechercher');
              finalMsg.style.display = 'block';
              setTimeout(()=>{
                const target = engine.url(q);
                if(redirect){
                  if(newtab){ window.open(target, '_blank', 'noopener'); }
                  window.location.href = target;
                }
              }, delay*1000);
            }
          }, Math.max(35, Math.min(85, 2400/(q.length||1))));
        }, 450);
      }
    })();
  </script>
</body>
</html>
